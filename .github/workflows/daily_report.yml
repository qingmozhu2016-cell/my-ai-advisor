name: ğŸ“Š æ¯æ—¥è´¢å¯Œæ—¥æŠ¥

on:
  # å®šæ—¶è§¦å‘ï¼šæ¯å¤©åŒ—äº¬æ—¶é—´ 6:45ï¼ˆUTC 22:45ï¼‰
  schedule:
    - cron: '45 22 * * *'
  
  # æ‰‹åŠ¨è§¦å‘ï¼ˆæ–¹ä¾¿æµ‹è¯•ï¼‰
  workflow_dispatch:

jobs:
  generate-report:
    runs-on: ubuntu-latest
    
    steps:
      # 1. æ£€å‡ºä»£ç 
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
      
      # 2. å®‰è£… Python
      - name: ğŸ Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      # 3. å®‰è£…ä¾èµ–
      - name: ğŸ“¦ Install Dependencies
        run: |
          pip install --upgrade pip
          pip install -r requirements.txt
      
      # 4. è¿è¡Œè„šæœ¬
      - name: ğŸš€ Generate Report
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
          EMAIL_USER: ${{ secrets.EMAIL_USER }}
          EMAIL_PASS: ${{ secrets.EMAIL_PASS }}
          EMAIL_TO: ${{ secrets.EMAIL_TO }}
        run: python financial_report.py
      
      # 5. (å¯é€‰) ä¸Šä¼ æŠ¥å‘Šä¸º Artifact
      - name: ğŸ“¤ Upload Report
        uses: actions/upload-artifact@v4
        with:
          name: daily-report
          path: AI_Reports/
          retention-days: 30
